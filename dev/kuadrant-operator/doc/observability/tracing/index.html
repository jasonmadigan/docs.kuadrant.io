
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docs.kuadrant.io/dev/kuadrant-operator/doc/observability/tracing/">
      
      
        <link rel="prev" href="../examples/">
      
      
        <link rel="next" href="../envoy-access-logs/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.44">
    
    
      
        <title>Tracing - Kuadrant Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.0253249f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../../assets/asciidoc.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#enabling-tracing-with-a-central-collector" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  These docs are not for the latest version.
  <a href="../../../../.."> 
    <strong>Click here to go to latest, stable docs.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Kuadrant Documentation" class="md-header__button md-logo" aria-label="Kuadrant Documentation" data-md-component="logo">
      
  <img src="../../../../assets/images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Kuadrant Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tracing
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/kuadrant/docs.kuadrant.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Kuadrant Documentation" class="md-nav__button md-logo" aria-label="Kuadrant Documentation" data-md-component="logo">
      
  <img src="../../../../assets/images/logo.png" alt="logo">

    </a>
    Kuadrant Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/kuadrant/docs.kuadrant.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../install-helm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install with Helm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../install-olm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install with OLM
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Concepts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architecture/docs/design/architectural-overview-v1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overviews/auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AuthPolicy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overviews/dns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DNSPolicy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overviews/rate-limiting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RateLimitPolicy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overviews/tls/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TLSPolicy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overviews/token-rate-limiting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TokenRateLimitPolicy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overviews/telemetrypolicy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TelemetryPolicy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extensions/planpolicy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PlanPolicy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_9" >
        
          
          <label class="md-nav__link" for="__nav_4_9" id="__nav_4_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CEL
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_9">
            <span class="md-nav__icon md-icon"></span>
            CEL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cel/introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cel/standard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Standard library
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cel/extensions/optional/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optional type
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cel/extensions/strings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    String extensions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    APIs & Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            APIs & Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/authpolicy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AuthPolicy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/dnspolicy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DNSPolicy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/ratelimitpolicy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RateLimitPolicy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/tlspolicy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TLSPolicy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/tokenratelimitpolicy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TokenRateLimitPolicy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/kuadrant/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kuadrant
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7" >
        
          
          <label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Observability
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            Observability
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../authorino/docs/user-guides/observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentication and Authorization
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/telemetrypolicy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TelemetryPolicy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guides/full-walkthrough/secure-protect-connect/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure, connect and protect
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guides/tls/gateway-tls/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gateway TLS for Cluster Operators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guides/auth/auth-for-app-devs-and-platform-engineers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enforcing authentication & authorization with Kuadrant AuthPolicy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guides/ratelimiting/gateway-rl-for-cluster-operators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gateway Rate Limiting for Cluster Operators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guides/ratelimiting/authenticated-rl-for-app-developers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authenticated Rate Limiting for Application Developers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guides/ratelimiting/authenticated-rl-with-jwt-and-k8s-authnz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authenticated Rate Limiting with JWTs and Kubernetes RBAC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guides/ratelimiting/multi-auth-rlp-diff-section/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gateway Rate Limiting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guides/ratelimiting/multi-auth-rlp-same-section/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi authenticated Rate Limiting for an Application
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guides/tokenratelimitpolicy/authenticated-token-ratelimiting-tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authenticated Token Rate Limiting for Large Language Model APIs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guides/planpolicy/plan-based-rate-limiting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plan-based Rate Limiting with PlanPolicy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Guides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1" >
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DNS configuration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            DNS configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../dns-operator/docs/provider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuring a DNS Provider
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guides/dns/gateway-dns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gateway DNS for ingress Gateway
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guides/dns/basic-dns-configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic DNS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guides/dns/load-balanced-dns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DNS Load Balancing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guides/dns/dnshealthchecks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Health Checks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guides/dns/core-dns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CoreDNS Support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guides/dns/understanding_dns_delegation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster Aware DNSRecord Delegation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_8" >
        
          
          <label class="md-nav__link" for="__nav_7_1_8" id="__nav_7_1_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DNS Fail-over
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1_8">
            <span class="md-nav__icon md-icon"></span>
            DNS Fail-over
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../dns-operator/docs/migrating_existing_clusters_to_use_groups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migrating Existing Clusters To Use Groups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../dns-operator/docs/exercising_dns_failover_via_groups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exercising DNS Fail-over via Groups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../dns-operator/docs/migrating_away_from_dns_groups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migrating Away From DNS Groups
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/mtls-configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mTLS Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" checked>
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Observability
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            Observability
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guides/observability/monitors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure Observability
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dashboards and Alerts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Tracing
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Tracing
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Steps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#istio-tracing-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Istio Tracing Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kuadrant-tracing-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Kuadrant Tracing Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kuadrant Tracing Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kuadrant-cr-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Kuadrant CR Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#direct-configuration-advanced" class="md-nav__link">
    <span class="md-ellipsis">
      Direct Configuration (Advanced)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-precedence" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Precedence
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#control-plane-tracing" class="md-nav__link">
    <span class="md-ellipsis">
      Control Plane Tracing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Control Plane Tracing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enabling-control-plane-tracing" class="md-nav__link">
    <span class="md-ellipsis">
      Enabling Control Plane Tracing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#control-plane-vs-data-plane-tracing" class="md-nav__link">
    <span class="md-ellipsis">
      Control Plane vs Data Plane Tracing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-control-plane-traces-show" class="md-nav__link">
    <span class="md-ellipsis">
      What Control Plane Traces Show
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewing-control-plane-traces" class="md-nav__link">
    <span class="md-ellipsis">
      Viewing Control Plane Traces
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tracing-policy-lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      Tracing Policy Lifecycle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#correlating-control-plane-and-data-plane-traces" class="md-nav__link">
    <span class="md-ellipsis">
      Correlating Control Plane and Data Plane Traces
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-development" class="md-nav__link">
    <span class="md-ellipsis">
      Local Development
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-control-plane-tracing" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting Control Plane Tracing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-data-plane-traces" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Data Plane Traces
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding Data Plane Traces">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites_1" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-youll-see" class="md-nav__link">
    <span class="md-ellipsis">
      What You'll See
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-complete-request-trace" class="md-nav__link">
    <span class="md-ellipsis">
      Example: Complete Request Trace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trace-attributes-youll-see" class="md-nav__link">
    <span class="md-ellipsis">
      Trace Attributes You'll See
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewing-this-trace-in-jaeger" class="md-nav__link">
    <span class="md-ellipsis">
      Viewing This Trace in Jaeger
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-this-shows-you" class="md-nav__link">
    <span class="md-ellipsis">
      What This Shows You
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-scenarios-with-traces" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting Scenarios with Traces
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enabling-gateway-debug-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Enabling Gateway Debug Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting-flow-using-traces-and-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting Flow Using Traces and Logs
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../envoy-access-logs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Envoy Access Logs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guides/observability/limitador-metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Monitoring Limitador
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guides/observability/token-metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Monitoring AI Token Metrics
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developer Portal
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Developer Portal
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../kuadrant-backstage-plugin/docs/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../kuadrant-backstage-plugin/docs/getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../kuadrant-backstage-plugin/docs/installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_4" >
        
          
          <label class="md-nav__link" for="__nav_8_4" id="__nav_8_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_4">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../developer-portal-controller/docs/references/apiproduct/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    APIProduct
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../developer-portal-controller/docs/references/apikey/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    APIKey
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    MCP Gateway
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            MCP Gateway
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1" >
        
          
          <label class="md-nav__link" for="__nav_9_1" id="__nav_9_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    About
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../mcp-gateway/docs/guides/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../mcp-gateway/docs/design/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../mcp-gateway/docs/guides/getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../mcp-gateway/docs/guides/how-to-install-and-configure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_4" >
        
          
          <label class="md-nav__link" for="__nav_9_4" id="__nav_9_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_4">
            <span class="md-nav__icon md-icon"></span>
            Configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../mcp-gateway/docs/guides/configure-mcp-gateway-listener-and-router/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listener and Router
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_5" >
        
          
          <label class="md-nav__link" for="__nav_9_5" id="__nav_9_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    MCP Servers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_5">
            <span class="md-nav__icon md-icon"></span>
            MCP Servers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../mcp-gateway/docs/guides/register-mcp-servers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MCP Server Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../mcp-gateway/docs/guides/virtual-mcp-servers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual MCP Servers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../mcp-gateway/docs/guides/external-mcp-server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External MCP Servers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_6" >
        
          
          <label class="md-nav__link" for="__nav_9_6" id="__nav_9_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Security
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_6">
            <span class="md-nav__icon md-icon"></span>
            Security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../mcp-gateway/docs/guides/authentication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../mcp-gateway/docs/guides/authorization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authorization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../mcp-gateway/docs/guides/vault-integration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vault Integration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_7" >
        
          
          <label class="md-nav__link" for="__nav_9_7" id="__nav_9_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Support
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_7">
            <span class="md-nav__icon md-icon"></span>
            Support
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../mcp-gateway/docs/guides/troubleshooting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Steps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#istio-tracing-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Istio Tracing Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kuadrant-tracing-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Kuadrant Tracing Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kuadrant Tracing Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kuadrant-cr-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Kuadrant CR Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#direct-configuration-advanced" class="md-nav__link">
    <span class="md-ellipsis">
      Direct Configuration (Advanced)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-precedence" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Precedence
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#control-plane-tracing" class="md-nav__link">
    <span class="md-ellipsis">
      Control Plane Tracing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Control Plane Tracing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enabling-control-plane-tracing" class="md-nav__link">
    <span class="md-ellipsis">
      Enabling Control Plane Tracing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#control-plane-vs-data-plane-tracing" class="md-nav__link">
    <span class="md-ellipsis">
      Control Plane vs Data Plane Tracing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-control-plane-traces-show" class="md-nav__link">
    <span class="md-ellipsis">
      What Control Plane Traces Show
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewing-control-plane-traces" class="md-nav__link">
    <span class="md-ellipsis">
      Viewing Control Plane Traces
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tracing-policy-lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      Tracing Policy Lifecycle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#correlating-control-plane-and-data-plane-traces" class="md-nav__link">
    <span class="md-ellipsis">
      Correlating Control Plane and Data Plane Traces
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-development" class="md-nav__link">
    <span class="md-ellipsis">
      Local Development
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-control-plane-tracing" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting Control Plane Tracing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-data-plane-traces" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Data Plane Traces
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding Data Plane Traces">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites_1" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-youll-see" class="md-nav__link">
    <span class="md-ellipsis">
      What You'll See
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-complete-request-trace" class="md-nav__link">
    <span class="md-ellipsis">
      Example: Complete Request Trace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trace-attributes-youll-see" class="md-nav__link">
    <span class="md-ellipsis">
      Trace Attributes You'll See
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewing-this-trace-in-jaeger" class="md-nav__link">
    <span class="md-ellipsis">
      Viewing This Trace in Jaeger
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-this-shows-you" class="md-nav__link">
    <span class="md-ellipsis">
      What This Shows You
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-scenarios-with-traces" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting Scenarios with Traces
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enabling-gateway-debug-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Enabling Gateway Debug Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting-flow-using-traces-and-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting Flow Using Traces and Logs
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/kuadrant/kuadrant-operator/blob/main/doc/observability/tracing.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="enabling-tracing-with-a-central-collector">Enabling tracing with a central collector<a class="headerlink" href="#enabling-tracing-with-a-central-collector" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>This guide outlines the steps to enable tracing in Istio and Kuadrant components (Authorino, Limitador, and wasm-shim), directing traces to a central collector for improved observability and troubleshooting. We'll also explore a typical troubleshooting flow using traces and logs.</p>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h2>
<ul>
<li>A Kubernetes cluster with Istio and Kuadrant installed.</li>
<li>A trace collector (e.g., Jaeger or Tempo) configured to support <a href="https://opentelemetry.io/">OpenTelemetry</a> (OTel).</li>
</ul>
<h2 id="configuration-steps">Configuration Steps<a class="headerlink" href="#configuration-steps" title="Permanent link">&para;</a></h2>
<h3 id="istio-tracing-configuration">Istio Tracing Configuration<a class="headerlink" href="#istio-tracing-configuration" title="Permanent link">&para;</a></h3>
<p>Enable tracing in Istio by using the <a href="https://istio.io/v1.20/docs/tasks/observability/distributed-tracing/telemetry-api/">Telemetry API</a>.
Depending on your method for installing Istio, you will need to configure a tracing <code>extensionProvider</code> in your MeshConfig, Istio or IstioOperator resource as well.
Here is an example Telemetry and Istio config to sample 100% of requests, if using the Istio Sail Operator.</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">telemetry.istio.io/v1alpha1</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Telemetry</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="nt">metadata</span><span class="p">:</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mesh-default</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gateway-system</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="nt">spec</span><span class="p">:</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">  </span><span class="nt">tracing</span><span class="p">:</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">providers</span><span class="p">:</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jaeger-collector</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="w">    </span><span class="nt">randomSamplingPercentage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="nn">---</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sailoperator.io/v1</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Istio</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="nt">metadata</span><span class="p">:</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="nt">spec</span><span class="p">:</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gateway-system</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="w">  </span><span class="nt">values</span><span class="p">:</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="w">    </span><span class="nt">meshConfig</span><span class="p">:</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="w">      </span><span class="nt">defaultConfig</span><span class="p">:</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="w">        </span><span class="nt">tracing</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="w">      </span><span class="nt">enableTracing</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="w">      </span><span class="nt">extensionProviders</span><span class="p">:</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jaeger-collector</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="w">        </span><span class="nt">opentelemetry</span><span class="p">:</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="w">          </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4317</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="w">          </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jaeger-collector.jaeger.svc.cluster.local</span>
</span></code></pre></div>
<p><strong>Important:</strong></p>
<p>The OpenTelemetry collector protocol should be explicitly set in the service port <code>name</code> or <code>appProtocol</code> fields as per the <a href="https://istio.io/latest/docs/ops/configuration/traffic-management/protocol-selection/#explicit-protocol-selection">Istio documentation</a>. For example, when using gRPC, the port <code>name</code> should begin with <code>grpc-</code> or the <code>appProtocol</code> should be <code>grpc</code>.</p>
<h3 id="kuadrant-tracing-configuration">Kuadrant Tracing Configuration<a class="headerlink" href="#kuadrant-tracing-configuration" title="Permanent link">&para;</a></h3>
<p>Kuadrant components (Authorino, Limitador, and Wasm-shim) have request tracing capabilities.
Configure tracing centrally via the Kuadrant CR to automatically propagate the configuration to all components.
Ensure the collector is the same one that Istio is sending traces so that they can be correlated later.</p>
<h4 id="kuadrant-cr-configuration">Kuadrant CR Configuration<a class="headerlink" href="#kuadrant-cr-configuration" title="Permanent link">&para;</a></h4>
<p>Configure tracing centrally in the Kuadrant CR. This configuration will be automatically propagated to:</p>
<ul>
<li><strong>Authorino</strong> (Auth service - authentication decisions)</li>
<li><strong>Limitador</strong> (Rate limiting service - rate limit checks)</li>
<li><strong>Wasm-shim</strong> (Envoy WebAssembly filter - gateway-level tracing)</li>
</ul>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kuadrant.io/v1beta1</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Kuadrant</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="nt">metadata</span><span class="p">:</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kuadrant</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kuadrant-system</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="nt">spec</span><span class="p">:</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">  </span><span class="nt">observability</span><span class="p">:</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">    </span><span class="nt">dataPlane</span><span class="p">:</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">      </span><span class="nt">defaultLevels</span><span class="p">:</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">debug</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="w">  </span><span class="c1"># Enable DEBUG level trace filtering</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="w">      </span><span class="nt">httpHeaderIdentifier</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x-request-id</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="w">    </span><span class="nt">tracing</span><span class="p">:</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="w">      </span><span class="nt">defaultEndpoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rpc://jaeger-collector.jaeger.svc.cluster.local:4317</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="w">      </span><span class="nt">insecure</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span></code></pre></div>
<p><strong>Tracing Configuration Fields:</strong></p>
<ul>
<li><code>defaultEndpoint</code>: The URL of the tracing collector backend (OTLP endpoint). Supported protocols:</li>
<li><code>rpc://</code> for gRPC OTLP (port 4317)</li>
<li><code>http://</code> for HTTP OTLP (port 4318)</li>
<li><code>insecure</code>: Set to <code>true</code> to skip TLS certificate verification (useful for development environments).</li>
</ul>
<p><strong>Important:</strong> Point to the <strong>collector</strong> service (e.g., <code>jaeger-collector</code>), not the query service. The collector receives traces from your applications, while the query service is only for viewing traces in the UI.</p>
<p>Once applied, the Authorino and Limitador components will be redeployed with tracing enabled.</p>
<p><strong>Data Plane Configuration Fields:</strong></p>
<ul>
<li><code>defaultLevels</code>: Controls the <strong>OpenTelemetry trace filtering level</strong> for the wasm-shim. This determines which trace spans are exported to your tracing collector.</li>
<li>Supported levels (highest to lowest verbosity): <code>debug</code>, <code>info</code>, <code>warn</code>, <code>error</code></li>
<li><strong>Current implementation (MVP)</strong>: Set to <code>"true"</code> to enable that level (e.g., <code>debug: "true"</code>)</li>
<li><strong>Future</strong>: Will support CEL expressions for dynamic request-time evaluation</li>
<li>Default: <code>WARN</code> if not specified</li>
<li>
<p>Priority: DEBUG &gt; INFO &gt; WARN &gt; ERROR (highest level set wins)</p>
</li>
<li>
<p><code>httpHeaderIdentifier</code>: Specifies the HTTP header name used to correlate requests in traces (e.g., <code>x-request-id</code>)</p>
</li>
</ul>
<p><strong>Important - Understanding what <code>defaultLevels</code> controls:</strong></p>
<p>The <code>defaultLevels</code> configuration controls <strong>trace span filtering</strong> sent to your observability backend (Jaeger, Tempo, etc.), <strong>not</strong> the verbosity of logs appearing in gateway pod output.</p>
<ul>
<li><strong>To view traces</strong>: Configure <code>defaultLevels</code> in the Kuadrant CR and view traces in your tracing UI (Jaeger/Grafana)</li>
<li><strong>To see debug logs in gateway pods</strong>: Configure Envoy's log level separately (see <a href="#enabling-gateway-debug-logs">Enabling Gateway Debug Logs</a> in the troubleshooting section)</li>
</ul>
<h4 id="direct-configuration-advanced">Direct Configuration (Advanced)<a class="headerlink" href="#direct-configuration-advanced" title="Permanent link">&para;</a></h4>
<p>For advanced use cases, you can configure tracing directly in the Authorino or Limitador CRs:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">operator.authorino.kuadrant.io/v1beta1</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Authorino</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="nt">metadata</span><span class="p">:</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">authorino</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="nt">spec</span><span class="p">:</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">  </span><span class="nt">tracing</span><span class="p">:</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">    </span><span class="nt">endpoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rpc://authorino-collector:4317</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="w">    </span><span class="nt">insecure</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="nn">---</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">limitador.kuadrant.io/v1alpha1</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Limitador</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="nt">metadata</span><span class="p">:</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">limitador</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="nt">spec</span><span class="p">:</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="w">  </span><span class="nt">tracing</span><span class="p">:</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="w">    </span><span class="nt">endpoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rpc://limitador-collector:4317</span>
</span></code></pre></div>
<p><strong>Important:</strong> When tracing is configured directly in Authorino or Limitador CRs, those settings take precedence over the Kuadrant CR configuration. The Kuadrant operator will cede ownership of the tracing field to you, allowing full control over component-specific tracing endpoints. This is useful when you need different collectors for different components.</p>
<h4 id="configuration-precedence">Configuration Precedence<a class="headerlink" href="#configuration-precedence" title="Permanent link">&para;</a></h4>
<p>The tracing configuration follows this precedence order:</p>
<ol>
<li><strong>Component-specific configuration</strong> (Authorino/Limitador CR) - highest priority</li>
<li><strong>Centralized configuration</strong> (Kuadrant CR) - applies when component CRs don't specify tracing</li>
</ol>
<p>If you set tracing in the Kuadrant CR and later configure it directly in an Authorino or Limitador CR, the component-specific configuration will take precedence, and the Kuadrant operator will no longer manage that component's tracing settings.</p>
<p><strong>Note on Trace Continuity:</strong></p>
<p>Currently, trace IDs <a href="https://github.com/envoyproxy/envoy/issues/22028">do not propagate</a> to WebAssembly modules in Istio/Envoy. This affects trace continuity when rate limiting is enforced, as requests may not have the relevant 'parent' trace ID in their trace information.</p>
<p>However, if the trace initiation point is outside of Envoy/Istio, the 'parent' trace ID will be available and included in traces passed to the collector. This limitation can impact correlating traces across the gateway, auth service, rate limiting, and other components in the request path.</p>
<p>Despite this, Kuadrant configures tracing for the wasm-shim when using the centralized configuration, ensuring that trace data is collected even if parent-child relationships may be limited in some scenarios.</p>
<h2 id="control-plane-tracing">Control Plane Tracing<a class="headerlink" href="#control-plane-tracing" title="Permanent link">&para;</a></h2>
<p>The Kuadrant operator itself (the control plane) exports traces to your OpenTelemetry collector, allowing you to observe the operator's reconciliation loops and internal operations. This is useful for debugging controller behavior, understanding operator performance, and tracking policy lifecycle events.</p>
<p><strong>Note:</strong> Control plane tracing may already be enabled in your installation. Check if you can see <code>kuadrant-operator</code> service in your tracing UI before configuring.</p>
<h3 id="enabling-control-plane-tracing">Enabling Control Plane Tracing<a class="headerlink" href="#enabling-control-plane-tracing" title="Permanent link">&para;</a></h3>
<p>The Kuadrant operator exposes OpenTelemetry environment variables for control plane tracing. To enable control plane tracing, you need to set these environment variables in your operator deployment. The method for setting these will depend on your deployment approach (e.g., using Kustomize, Helm, OLM, or direct YAML manifests).</p>
<p><strong>Available environment variables:</strong></p>
<table>
<thead>
<tr>
<th>Environment Variable</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>OTEL_EXPORTER_OTLP_ENDPOINT</code></td>
<td>OTLP collector endpoint for all signals (logs, traces, metrics). Supports <code>http://</code>, <code>https://</code>, <code>rpc://</code> schemes</td>
<td>- (tracing disabled)</td>
</tr>
<tr>
<td><code>OTEL_EXPORTER_OTLP_TRACES_ENDPOINT</code></td>
<td>OTLP traces-specific endpoint (overrides <code>OTEL_EXPORTER_OTLP_ENDPOINT</code>)</td>
<td>-</td>
</tr>
<tr>
<td><code>OTEL_EXPORTER_OTLP_INSECURE</code></td>
<td>Disable TLS for OTLP export</td>
<td><code>false</code></td>
</tr>
<tr>
<td><code>OTEL_SERVICE_NAME</code></td>
<td>Service name for telemetry data</td>
<td><code>kuadrant-operator</code></td>
</tr>
<tr>
<td><code>OTEL_SERVICE_VERSION</code></td>
<td>Service version for telemetry data</td>
<td>Build version (from ldflags)</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> Tracing is enabled when either <code>OTEL_EXPORTER_OTLP_ENDPOINT</code> or <code>OTEL_EXPORTER_OTLP_TRACES_ENDPOINT</code> is set to a non-empty value.</p>
<p><strong>Example values:</strong></p>
<ul>
<li><code>OTEL_EXPORTER_OTLP_ENDPOINT=rpc://jaeger-collector.jaeger.svc.cluster.local:4317</code></li>
<li><code>OTEL_EXPORTER_OTLP_INSECURE=true</code> (use <code>false</code> in production with TLS)</li>
</ul>
<p>Control plane traces will appear under service name <code>kuadrant-operator</code> in Jaeger/Grafana.</p>
<h3 id="control-plane-vs-data-plane-tracing">Control Plane vs Data Plane Tracing<a class="headerlink" href="#control-plane-vs-data-plane-tracing" title="Permanent link">&para;</a></h3>
<p>Kuadrant supports tracing at two levels:</p>
<ol>
<li><strong>Control Plane Tracing</strong> (this section): Traces the operator's reconciliation loops and internal operations</li>
<li>Shows policy lifecycle events, topology building, resource creation</li>
<li>
<p>Helps debug operator behavior and performance</p>
</li>
<li>
<p><strong>Data Plane Tracing</strong> (see configuration above): Traces actual user requests through the gateway and policy enforcement components</p>
</li>
<li>Shows request flows through Istio/Envoy, Authorino, Limitador, and wasm-shim</li>
<li>Helps debug request-level issues and policy enforcement</li>
</ol>
<p><strong>Configuration:</strong></p>
<ul>
<li><strong>Control Plane</strong>: Configured via environment variables in the operator deployment (see "Enabling Control Plane Tracing" above)</li>
<li><strong>Data Plane</strong>: Configured via the Kuadrant CR (<code>spec.observability.tracing</code>)</li>
</ul>
<p>When both are configured to send traces to the same collector, you get a complete view of your Kuadrant system from policy reconciliation to request processing.</p>
<h3 id="what-control-plane-traces-show">What Control Plane Traces Show<a class="headerlink" href="#what-control-plane-traces-show" title="Permanent link">&para;</a></h3>
<p>Control plane traces capture operator activities such as:</p>
<ul>
<li><strong>Policy reconciliation</strong>: When a policy (AuthPolicy, RateLimitPolicy, DNSPolicy, TLSPolicy) is created, updated, or deleted</li>
<li><strong>Resource creation</strong>: Creating Authorino AuthConfigs, Limitador configurations, wasm-shim, etc.</li>
<li><strong>Gateway topology discovery</strong>: Analyzing Gateway API resources and computing policy attachments</li>
<li><strong>Status updates</strong>: Updating policy status conditions</li>
<li><strong>Conflict detection</strong>: Detecting and resolving policy conflicts</li>
<li><strong>Error handling</strong>: Tracking reconciliation errors and retries</li>
</ul>
<p>These traces are separate from data plane traces (actual user requests) and help operators understand what the Kuadrant operator is doing behind the scenes.</p>
<h3 id="viewing-control-plane-traces">Viewing Control Plane Traces<a class="headerlink" href="#viewing-control-plane-traces" title="Permanent link">&para;</a></h3>
<p>Once control plane tracing is enabled, you can view operator traces in Jaeger or Grafana:</p>
<p><strong>Using Jaeger UI:</strong></p>
<ol>
<li>Port-forward to Jaeger Query service:
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>kubectl<span class="w"> </span>port-forward<span class="w"> </span>-n<span class="w"> </span>&lt;jaeger-namespace&gt;<span class="w"> </span>svc/jaeger-query<span class="w"> </span><span class="m">16686</span>:80
</span></code></pre></div></li>
</ol>
<p>Or if using the Jaeger all-in-one deployment:
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>kubectl<span class="w"> </span>port-forward<span class="w"> </span>-n<span class="w"> </span>&lt;jaeger-namespace&gt;<span class="w"> </span>svc/jaeger<span class="w"> </span><span class="m">16686</span>:16686
</span></code></pre></div></p>
<ol>
<li>
<p>Open http://localhost:16686</p>
</li>
<li>
<p>Select service: <strong>kuadrant-operator</strong></p>
</li>
<li>
<p>Search for traces by:</p>
</li>
<li><strong>Operation name</strong>: Look for operations like <code>controller.reconcile</code>, <code>workflow.data_plane_policies</code></li>
<li><strong>Tags</strong>: Filter by specific policy using <code>policy.name=my-policy-name</code></li>
<li><strong>Duration</strong>: Find slow reconciliations (e.g., min duration &gt; 100ms)</li>
</ol>
<p><strong>Example searches:</strong></p>
<p>Find all traces for a specific RateLimitPolicy:
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>Service: kuadrant-operator
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>Tags: policy.name=my-ratelimitpolicy
</span></code></pre></div></p>
<p>Find slow reconciliations for data plane policies:
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>Service: kuadrant-operator
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>Operation: workflow.data_plane_policies
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>Min Duration: 100ms
</span></code></pre></div></p>
<p><strong>Example Trace Spans:</strong></p>
<p>A typical reconciliation loop generates traces showing the workflow structure:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>controller.reconcile (29.8ms)
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a> topology.build (495s)
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a> workflow.init (12.56ms)
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>   init.topology_reconciler (10.41ms)
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a> workflow.data_plane_policies (15.73ms)
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>   validation (72s)
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>   effective_policies (3.01ms)
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>     effective_policies.auth
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>     effective_policies.ratelimit
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>     effective_policies.token_ratelimit
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>   reconciler.auth_configs (293s)
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>   reconciler.limitador_limits (216s)
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>   wasm.BuildConfigForPath (142s)
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a> status_update (12.64ms)
</span></code></pre></div>
<p>The trace structure reflects the operator's workflow-based reconciliation:</p>
<p><strong>Main Workflows:</strong></p>
<ul>
<li><strong>controller.reconcile</strong>: Main reconciliation entry point for all policy changes</li>
<li><strong>topology.build</strong>: Building the Gateway API topology graph</li>
<li><strong>workflow.init</strong>: Initialization workflow (topology reconciliation, event logging)</li>
<li><strong>workflow.data_plane_policies</strong>: Auth and rate limiting policy reconciliation</li>
<li><strong>workflow.dns</strong>: DNS policy reconciliation (when DNS policies are present)</li>
<li><strong>workflow.tls</strong>: TLS policy reconciliation (when TLS policies are present)</li>
<li><strong>workflow.observability</strong>: Observability configuration reconciliation</li>
<li><strong>workflow.limitador</strong>: Limitador deployment reconciliation (when Limitador operator is installed)</li>
<li><strong>workflow.authorino</strong>: Authorino deployment reconciliation (when Authorino operator is installed)</li>
<li><strong>status_update</strong>: Final workflow for updating policy statuses</li>
</ul>
<p><strong>Data Plane Policy Workflow Spans:</strong></p>
<ul>
<li><strong>validation</strong>: Validates AuthPolicy, RateLimitPolicy, TokenRateLimitPolicy resources</li>
<li><strong>effective_policies</strong>: Computes effective policies for each HTTPRoute and Gateway</li>
<li><code>effective_policies.auth</code>: Effective auth policies</li>
<li><code>effective_policies.ratelimit</code>: Effective rate limit policies</li>
<li><code>effective_policies.token_ratelimit</code>: Effective token rate limit policies</li>
<li><strong>reconciler.auth_configs</strong>: Reconciles Authorino AuthConfig resources</li>
<li><strong>reconciler.limitador_limits</strong>: Reconciles Limitador limit configurations</li>
<li><strong>reconciler.istio_extension</strong>: Reconciles Istio WasmPlugin and EnvoyFilter resources (when Istio is the gateway provider)</li>
<li><strong>reconciler.envoy_gateway_extension</strong>: Reconciles Envoy Gateway extension policies (when Envoy Gateway is the provider)</li>
<li><strong>wasm.BuildConfigForPath</strong>: Builds wasm-shim configuration for a specific HTTPRoute path</li>
</ul>
<h3 id="tracing-policy-lifecycle">Tracing Policy Lifecycle<a class="headerlink" href="#tracing-policy-lifecycle" title="Permanent link">&para;</a></h3>
<p>To trace a specific policy creation or update:</p>
<ol>
<li>
<p><strong>Create or update a policy</strong>:
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>my-ratelimitpolicy.yaml
</span></code></pre></div></p>
</li>
<li>
<p><strong>Get the policy creation/update timestamp</strong>:
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>ratelimitpolicy<span class="w"> </span>my-policy<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.metadata.creationTimestamp}&#39;</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Search in Jaeger</strong>:</p>
</li>
<li>Set the time range around the policy change timestamp</li>
<li>Look for operation: <code>controller.reconcile</code></li>
<li>Expand the trace to see workflow details like <code>workflow.data_plane_policies</code></li>
<li>Look for specific reconciler spans like <code>reconciler.limitador_limits</code> or <code>reconciler.auth_configs</code></li>
<li>Check timing information to identify performance bottlenecks</li>
</ol>
<h3 id="correlating-control-plane-and-data-plane-traces">Correlating Control Plane and Data Plane Traces<a class="headerlink" href="#correlating-control-plane-and-data-plane-traces" title="Permanent link">&para;</a></h3>
<p>While control plane and data plane traces are separate, you can correlate them:</p>
<ol>
<li><strong>Control plane trace</strong>: Shows when a policy was reconciled and resources created</li>
<li><strong>Data plane trace</strong>: Shows actual user requests processed with that policy</li>
</ol>
<p>Example workflow:</p>
<ol>
<li>Create a RateLimitPolicy at <code>15:30:00</code></li>
<li>View control plane trace to see:</li>
<li>Policy reconciliation completed at <code>15:30:05</code></li>
<li>Limitador configuration updated</li>
<li>WASM plugin deployed</li>
<li>Send a test request at <code>15:30:10</code></li>
<li>View data plane trace to see:</li>
<li>Request processed through the wasm-shim</li>
<li>Rate limit check sent to Limitador</li>
<li>Response returned</li>
</ol>
<h3 id="local-development">Local Development<a class="headerlink" href="#local-development" title="Permanent link">&para;</a></h3>
<p>For local development, you can run the operator with control plane tracing enabled by setting environment variables:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1"># Start Jaeger or an OTel collector</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>docker<span class="w"> </span>compose<span class="w"> </span>-f<span class="w"> </span>examples/otel/docker-compose.yaml<span class="w"> </span>up<span class="w"> </span>-d
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="c1"># Run the operator with OpenTelemetry enabled</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="c1"># Note: When running locally, env vars are used instead of the Kuadrant CR</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="nb">export</span><span class="w"> </span><span class="nv">OTEL_EXPORTER_OTLP_INSECURE</span><span class="o">=</span><span class="nb">true</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="nb">export</span><span class="w"> </span><span class="nv">OTEL_EXPORTER_OTLP_ENDPOINT</span><span class="o">=</span>http://localhost:4318
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>make<span class="w"> </span>run
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="c1"># View traces in Jaeger (http://localhost:16686)</span>
</span></code></pre></div>
<p><strong>Note:</strong> Control plane tracing is always configured via environment variables (whether running locally or in-cluster). Data plane tracing is configured via the Kuadrant CR.</p>
<p>See the <a href="../../../examples/otel/">OpenTelemetry example</a> for complete local development setup with Grafana, Tempo, Jaeger, Loki, and Prometheus.</p>
<h3 id="configuration-notes">Configuration Notes<a class="headerlink" href="#configuration-notes" title="Permanent link">&para;</a></h3>
<p>When you configure tracing via the Kuadrant CR (<code>spec.observability.tracing</code>), it automatically enables tracing for:</p>
<ul>
<li><strong>Data Plane</strong>: Authorino, Limitador, and Wasm-shim</li>
</ul>
<p>For <strong>control plane tracing</strong> (the operator's reconciliation loops), you must configure environment variables in the operator deployment as described in the section above.</p>
<p>The combination of control plane environment variables and Kuadrant CR data plane configuration provides complete tracing across your entire Kuadrant deployment.</p>
<h3 id="troubleshooting-control-plane-tracing">Troubleshooting Control Plane Tracing<a class="headerlink" href="#troubleshooting-control-plane-tracing" title="Permanent link">&para;</a></h3>
<p><strong>Traces not appearing in Jaeger:</strong></p>
<ol>
<li>Check if tracing is configured in the Kuadrant CR:
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>kuadrant<span class="w"> </span>kuadrant<span class="w"> </span>-n<span class="w"> </span>kuadrant-system<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.spec.observability.tracing}&#39;</span>
</span></code></pre></div></li>
</ol>
<p>Expected output should show <code>defaultEndpoint</code> configured:
   <div class="language-json highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="p">{</span><span class="nt">&quot;defaultEndpoint&quot;</span><span class="p">:</span><span class="s2">&quot;rpc://jaeger-collector.jaeger.svc.cluster.local:4317&quot;</span><span class="p">,</span><span class="nt">&quot;insecure&quot;</span><span class="p">:</span><span class="kc">true</span><span class="p">}</span>
</span></code></pre></div></p>
<ol>
<li>
<p>Check operator logs for OTLP connection errors:
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>kubectl<span class="w"> </span>logs<span class="w"> </span>-n<span class="w"> </span>kuadrant-system<span class="w"> </span>-l<span class="w"> </span>control-plane<span class="o">=</span>controller-manager<span class="w"> </span>--tail<span class="o">=</span><span class="m">50</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>otel
</span></code></pre></div></p>
</li>
<li>
<p>Verify the tracing collector endpoint is reachable from the operator:
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># For HTTP OTLP endpoint (port 4318)</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>kubectl<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-n<span class="w"> </span>kuadrant-system<span class="w"> </span>deployment/kuadrant-operator-controller-manager<span class="w"> </span>--<span class="w"> </span><span class="se">\</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">  </span>curl<span class="w"> </span>-v<span class="w"> </span>http://jaeger-collector.jaeger.svc.cluster.local:4318/v1/traces
</span></code></pre></div></p>
</li>
<li>
<p>Test sending traces to the collector directly:
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># Port-forward to the collector for local testing</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>kubectl<span class="w"> </span>port-forward<span class="w"> </span>-n<span class="w"> </span>&lt;jaeger-namespace&gt;<span class="w"> </span>svc/jaeger-collector<span class="w"> </span><span class="m">4318</span>:4318
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="c1"># Send a test trace</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>http://localhost:4318/v1/traces<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;resourceSpans&quot;:[]}&#39;</span>
</span></code></pre></div></p>
</li>
</ol>
<p><strong>Traces are incomplete or missing spans:</strong></p>
<ul>
<li>Check for errors in the operator logs that might indicate reconciliation failures</li>
<li>Verify the collector is not dropping spans due to rate limiting or storage issues</li>
<li>Check the collector's own logs for processing errors</li>
</ul>
<h2 id="understanding-data-plane-traces">Understanding Data Plane Traces<a class="headerlink" href="#understanding-data-plane-traces" title="Permanent link">&para;</a></h2>
<h3 id="prerequisites_1">Prerequisites<a class="headerlink" href="#prerequisites_1" title="Permanent link">&para;</a></h3>
<p>Before you can view data plane traces, ensure you have:</p>
<ol>
<li><strong>Tracing collector deployed</strong> - Jaeger, Tempo, or another OTLP-compatible collector</li>
<li><strong>Kuadrant CR configured with tracing endpoint</strong>:
   <div class="language-yaml highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="nt">spec</span><span class="p">:</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">  </span><span class="nt">observability</span><span class="p">:</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">    </span><span class="nt">tracing</span><span class="p">:</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">      </span><span class="nt">defaultEndpoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rpc://jaeger-collector.jaeger.svc.cluster.local:4317</span>
</span></code></pre></div></li>
<li><strong>At least one policy applied</strong> - AuthPolicy or RateLimitPolicy on a Gateway or HTTPRoute</li>
<li><strong>Traffic flowing through the gateway</strong> - Send requests to see traces</li>
</ol>
<p>Without these prerequisites, you won't see traces in your tracing UI even if <code>defaultLevels</code> is configured.</p>
<h3 id="what-youll-see">What You'll See<a class="headerlink" href="#what-youll-see" title="Permanent link">&para;</a></h3>
<p>When data plane tracing is enabled with <code>defaultLevels: debug</code>, you'll see detailed trace spans showing the complete request flow through Kuadrant components.</p>
<h3 id="example-complete-request-trace">Example: Complete Request Trace<a class="headerlink" href="#example-complete-request-trace" title="Permanent link">&para;</a></h3>
<p>Here's what a typical traced request looks like when it flows through auth and rate limiting policies:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>Request Flow (29.4ms total):
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a> Envoy Gateway Span (34.7ms)
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>   kuadrant_filter (29.4ms)
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>     
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>      auth (6.8ms)
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>        auth_request (1.2ms)
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>          Authorino gRPC Call
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>             envoy.service.auth.v3.Authorization/Check (2.0ms)
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>                Check (1.7ms)
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>        auth_response (56s)
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>     
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>      ratelimit (6.0ms)
</span><span id="__span-17-14"><a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>         ratelimit_request (576s)
</span><span id="__span-17-15"><a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a>           Limitador gRPC Call
</span><span id="__span-17-16"><a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a>              should_rate_limit (309s)
</span><span id="__span-17-17"><a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a>                 check_and_update (36s)
</span><span id="__span-17-18"><a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a>         ratelimit_response (38s)
</span><span id="__span-17-19"><a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a>
</span><span id="__span-17-20"><a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a> Backend Service: httpbin (34.7ms)
</span></code></pre></div>
<h3 id="trace-attributes-youll-see">Trace Attributes You'll See<a class="headerlink" href="#trace-attributes-youll-see" title="Permanent link">&para;</a></h3>
<p>Data plane traces include rich context from multiple services:</p>
<p><strong>Wasm-shim Spans</strong> (service: <code>wasm-shim</code>):</p>
<ul>
<li>Request correlation IDs from <code>httpHeaderIdentifier</code> configuration</li>
<li>Matched hostname and route configuration details</li>
<li>Policy attribution showing which AuthPolicy/RateLimitPolicy rules were evaluated</li>
<li>At DEBUG level: Detailed gRPC call information, property updates, and header manipulations</li>
</ul>
<p><strong>Authorino Spans</strong> (service: <code>authorino</code>):</p>
<ul>
<li>Request ID correlation</li>
<li>gRPC service calls and status codes</li>
<li>Authentication and authorization decision details</li>
</ul>
<p><strong>Limitador Spans</strong> (service: <code>limitador</code>):</p>
<ul>
<li>Rate limit check requests with trace context</li>
<li>Limit descriptors and counter information</li>
</ul>
<h3 id="viewing-this-trace-in-jaeger">Viewing This Trace in Jaeger<a class="headerlink" href="#viewing-this-trace-in-jaeger" title="Permanent link">&para;</a></h3>
<p><strong>Search by Request ID:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>Service: wasm-shim
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>Tags: request_id=adefc8cf-78af-9db7-97e5-5ae5e2b22c05
</span></code></pre></div></p>
<p><strong>Filter by Operation:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>Service: wasm-shim
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>Operation: kuadrant_filter
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>Min Duration: 10ms
</span></code></pre></div></p>
<p><strong>Examine Specific Policy:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>Service: wasm-shim
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>Tags: sources=authpolicy.kuadrant.io:kuadrant/my-auth-policy
</span></code></pre></div></p>
<h3 id="what-this-shows-you">What This Shows You<a class="headerlink" href="#what-this-shows-you" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Complete Request Timeline</strong>: See exactly how long each component took</li>
<li>Auth check: 6.8ms (including Authorino processing)</li>
<li>Rate limit check: 6.0ms (including Limitador processing)</li>
<li>
<p>Total protection time: 12.8ms (wasm-shim)</p>
</li>
<li>
<p><strong>Request Correlation</strong>: Request IDs flow across all services (wasm-shim, Authorino, Limitador) for end-to-end tracing</p>
</li>
<li>
<p><strong>Policy Attribution</strong>: Trace attributes identify which policies (AuthPolicy, RateLimitPolicy) were evaluated for each request</p>
</li>
<li>
<p><strong>gRPC Call Details</strong>: At DEBUG level, traces include detailed information about calls to Authorino and Limitador services</p>
</li>
</ol>
<h3 id="troubleshooting-scenarios-with-traces">Troubleshooting Scenarios with Traces<a class="headerlink" href="#troubleshooting-scenarios-with-traces" title="Permanent link">&para;</a></h3>
<p><strong>Scenario: Auth is slow</strong></p>
<ol>
<li>Find the trace in Jaeger by <code>request_id</code></li>
<li>Expand the <code>auth</code> span</li>
<li>Check the <code>auth_request</code>  <code>Check</code> span duration</li>
<li>Check Authorino pod logs for detailed errors or retries:
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>kubectl<span class="w"> </span>logs<span class="w"> </span>-n<span class="w"> </span>kuadrant-system<span class="w"> </span>-l<span class="w"> </span><span class="nv">app</span><span class="o">=</span>authorino<span class="w"> </span>--tail<span class="o">=</span><span class="m">100</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>&lt;request_id&gt;
</span></code></pre></div></li>
</ol>
<p><strong>Scenario: Rate limit not working</strong></p>
<ol>
<li>Search for traces with <code>operation: ratelimit</code></li>
<li>Check the <code>sources</code> tag - is your RateLimitPolicy listed?</li>
<li>Check Limitador's <code>should_rate_limit</code> span for the decision</li>
<li>Check Limitador pod logs for the limit descriptors sent:
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>kubectl<span class="w"> </span>logs<span class="w"> </span>-n<span class="w"> </span>kuadrant-system<span class="w"> </span>-l<span class="w"> </span><span class="nv">app</span><span class="o">=</span>limitador<span class="w"> </span>--tail<span class="o">=</span><span class="m">100</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>&lt;request_id&gt;
</span></code></pre></div></li>
</ol>
<p><strong>Scenario: Find which policy is rejecting requests</strong></p>
<ol>
<li>Filter traces by response code: <code>Tags: http.status_code=403</code></li>
<li>Look at the <code>sources</code> tag to identify the policy</li>
<li>Check the span that completed just before the rejection</li>
<li>Check component pod logs for detailed rejection reasons (Authorino or gateway logs depending on the policy)</li>
</ol>
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h2>
<h3 id="enabling-gateway-debug-logs">Enabling Gateway Debug Logs<a class="headerlink" href="#enabling-gateway-debug-logs" title="Permanent link">&para;</a></h3>
<p>The wasm-shim's logs you see via <code>kubectl logs</code> are controlled by <strong>Envoy's log level</strong>, not the Kuadrant CR <code>defaultLevels</code> setting.</p>
<p>To enable debug logging in gateway pod output:</p>
<p><strong>For Istio gateways (dynamic - temporary):</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c1"># Port-forward to Envoy admin interface</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>kubectl<span class="w"> </span>port-forward<span class="w"> </span>-n<span class="w"> </span>istio-system<span class="w"> </span>deploy/istio-ingressgateway<span class="w"> </span><span class="m">15000</span>:15000
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="c1"># Enable WASM debug logging</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span><span class="s1">&#39;http://localhost:15000/logging?wasm=debug&#39;</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="c1"># Or enable debug for all components:</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span><span class="s1">&#39;http://localhost:15000/logging?level=debug&#39;</span>
</span></code></pre></div>
<p><strong>Note:</strong> Most gateway pods don't have <code>curl</code> installed, so we use port-forwarding to access the Envoy admin interface from your local machine. This setting is temporary and will reset when the pod restarts.</p>
<p><strong>For Istio gateways (persistent - via Sail Operator):</strong></p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sailoperator.io/v1</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Istio</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="nt">metadata</span><span class="p">:</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="nt">spec</span><span class="p">:</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="w">  </span><span class="nt">values</span><span class="p">:</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="w">    </span><span class="nt">meshConfig</span><span class="p">:</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="w">      </span><span class="nt">defaultConfig</span><span class="p">:</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="w">        </span><span class="nt">proxyMetadata</span><span class="p">:</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="w">          </span><span class="nt">WASM_LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">debug</span>
</span></code></pre></div>
<p><strong>For Envoy Gateway:</strong></p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gateway.envoyproxy.io/v1alpha1</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EnvoyProxy</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="nt">metadata</span><span class="p">:</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custom-proxy-config</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">envoy-gateway-system</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="nt">spec</span><span class="p">:</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="w">  </span><span class="nt">logging</span><span class="p">:</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="w">    </span><span class="nt">level</span><span class="p">:</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="w">      </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">debug</span>
</span></code></pre></div>
<p><strong>Use Cases:</strong></p>
<ol>
<li><strong>Troubleshooting in production with traces</strong>: Set <code>defaultLevels.debug: "true"</code> in the Kuadrant CR to get detailed trace spans in Jaeger without flooding gateway logs</li>
<li><strong>Local development debugging</strong>: Enable both <code>defaultLevels.debug</code> AND Envoy's WASM log level for complete visibility</li>
<li><strong>Request correlation</strong>: Set <code>httpHeaderIdentifier: x-request-id</code> to track requests across components using the request ID header</li>
</ol>
<h2 id="troubleshooting-flow-using-traces-and-logs">Troubleshooting Flow Using Traces and Logs<a class="headerlink" href="#troubleshooting-flow-using-traces-and-logs" title="Permanent link">&para;</a></h2>
<p>Using a tracing interface like the Jaeger UI or Grafana, you can search for trace information by the trace ID.
You may get the trace ID from logs, or from a header in a sample request you want to troubleshoot.
You can also search for recent traces, filtering by the service you want to focus on.</p>
<p>Here is an example trace in the Jaeger UI showing the total request time from the gateway (Istio), the time to check the curent rate limit count (and update it) in limitador and the time to check auth in Authorino:</p>
<p><img alt="Trace in Jaeger UI" src="../jaeger_ui_trace.png" /></p>
<p>In limitador, it is possible to enable request logging with trace IDs to get more information on requests.
This requires the log level to be increased to at least debug, so the verbosity must be set to 3 or higher in the Limitador CR. For example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">limitador.kuadrant.io/v1alpha1</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Limitador</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="nt">metadata</span><span class="p">:</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">limitador</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="nt">spec</span><span class="p">:</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="w">  </span><span class="nt">verbosity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
</span></code></pre></div>
<p>A log entry will look something like this, with the <code>traceparent</code> field holding the trace ID:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>&quot;ShouldRateLimit Request received: Request { metadata: MetadataMap { headers: {&quot;te&quot;: &quot;trailers&quot;, &quot;grpc-timeout&quot;: &quot;1000m&quot;, &quot;content-type&quot;: &quot;application/grpc&quot;, &quot;traceparent&quot;: &quot;00-bd579c77366d2868ec14a69d0abd2b6d-532e38f2d4e17132-01&quot;, &quot;x-request-id&quot;: &quot;b18cf0b0-29d8-9feb-bcfb-a0dc08479400&quot;, &quot;x-envoy-internal&quot;: &quot;true&quot;, &quot;x-envoy-expected-rq-timeout-ms&quot;: &quot;1000&quot;} }, message: RateLimitRequest { domain: &quot;kuadrant/route-tester--d304&quot;, descriptors: [RateLimitDescriptor { entries: [Entry { key: &quot;limit.testuser__2feff48d&quot;, value: &quot;1&quot; }], limit: None }], hits_addend: 1 }, extensions: Extensions }&quot;
</span></code></pre></div>
<p>If you centrally aggregate logs using something like promtail and loki, you can jump between trace information and the relevant logs for that service:</p>
<p><img alt="Trace and logs in Grafana UI" src="../jaeger_ui_tracing_logs.png" /></p>
<p>Using a combination of tracing and logs, you can visualise and troubleshoot request timing issues and drill down to specific services.
This method becomes even more powerful when combined with <a href="https://docs.kuadrant.io/latest/kuadrant-operator/doc/observability/metrics/">metrics</a>, <a href="../envoy-access-logs/">access logs</a>, and <a href="https://docs.kuadrant.io/latest/kuadrant-operator/doc/observability/examples/">dashboards</a> to get a more complete picture of your users traffic.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer id="footer" class="footer">
  <div class="copyright">
    <p>Copyright <strong><span>The Kuadrant Contributors</span></strong>.</p>
    <p>The Linux Foundation (TLF) has registered trademarks and uses trademarks.</p> 
    <p>For a list of TLF trademarks, see <a href="https://www.linuxfoundation.org/trademark-usage/">Trademark Usage</a></p>
  </div>

  <div class="sponsored-by">
    <p>
      <a href="https://www.cncf.io/sandbox-projects/"><img src="../../../../assets/images/cncf-color.png" class="logo" alt="CNCF logo"></a>
    </p>
    <p>
      We are a Cloud Native Computing Foundation sandbox project.
    </p>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.action.edit", "content.code.copy"], "search": "../../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": ["1.3.x", "latest"], "provider": "mike"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../../../assets/strip_callouts.js"></script>
      
    
  </body>
</html>